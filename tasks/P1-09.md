# ID: P1-09
## Title
Download hardening: safe filenames, blob URL lifecycle, CSP compatibility

## Context
- Tools will generate outputs as blobs/ArrayBuffers and trigger downloads.
- Must avoid memory leaks and unsafe filenames, and align with CSP.

## Steps
1. Add a shared `downloadBuffer()` utility that:
   - sanitizes filenames (fa/en)
   - uses `URL.createObjectURL` and always `revokeObjectURL`
2. Enforce extension correctness and MIME types.
3. Add tests for filename sanitization and revocation behavior (where feasible).

## Acceptance criteria
- Generated downloads always have safe filenames and correct extensions.
- No persistent blob URLs remain after downloads in long sessions.

## Dependencies
- `P0-05`

## Files to modify (best guess)
- Add `src/lib/download.ts`
- Add `src/lib/validators.ts` (for filename helpers)
- Add unit tests under `src/__tests__/lib/*`

