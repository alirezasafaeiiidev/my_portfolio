# ID: P0-01
## Title
Wire security middleware (CSP nonce + headers + admin edge protection)

## Context
- `src/proxy.ts` defines a CSP + security header strategy and injects `x-csp-nonce` into the request, but **there is no source middleware file** (no `middleware.ts`/`src/middleware.ts`), so this logic is likely not active in production.
- `src/app/layout.tsx` reads `x-csp-nonce` from headers and passes it into JSON-LD scripts via `src/components/seo/json-ld.tsx`.

## Steps
1. Add a Next.js middleware entrypoint (root `middleware.ts` or `src/middleware.ts`) that calls `proxy(request)` from `src/proxy.ts`.
2. Ensure the middleware runs for intended paths (use `src/proxy.ts` `config.matcher`).
3. Verify headers are consistent with `next.config.ts` (avoid contradictory values like `X-Frame-Options`).
4. Add/extend tests to assert:
   - `Content-Security-Policy` exists on public pages.
   - `x-csp-nonce` is present and is consumed by `src/app/layout.tsx` and applied to JSON-LD `<script>` tags.
5. Verify admin access rules remain intact (redirect or client-side gating should not regress).

## Acceptance criteria
- Visiting `/` returns `Content-Security-Policy` and other baseline headers (e.g., `Cross-Origin-Opener-Policy`), and `x-csp-nonce` is present on SSR requests.
- JSON-LD script tags rendered by `src/components/seo/json-ld.tsx` include a `nonce` attribute (when middleware active).
- `pnpm run test` passes; `pnpm run test:e2e:smoke` still passes for `/admin` gating.

## Dependencies
- None

## Files to modify (best guess)
- `src/proxy.ts`
- `src/app/layout.tsx`
- `src/components/seo/json-ld.tsx`
- `src/__tests__/lib/security.test.ts`
- Add `middleware.ts` (new)

