
> nextjs_tailwind_shadcn_ts@0.2.0 test /workspace/asdev-portfolio
> vitest run


 RUN  v4.0.18 /workspace/asdev-portfolio

 ✓ src/__tests__/lib/persian-utils.test.ts (38 tests) 60ms
 ✓ src/__tests__/lib/validators.test.ts (26 tests) 22ms
 ✓ src/__tests__/lib/security.test.ts (36 tests) 49ms
 ✓ src/__tests__/lib/logger.test.ts (2 tests) 102ms
 ✓ src/__tests__/lib/i18n-translations.test.ts (2 tests) 45ms
stderr | src/__tests__/lib/rate-limit.test.ts > rate-limit > falls back to memory when redis returns non-2xx
{"ts":"2026-02-18T05:33:59.477Z","level":"warn","message":"Redis rate limit request failed","context":{"status":500,"identifier":"redis-non-2xx"}}

stderr | src/__tests__/lib/rate-limit.test.ts > rate-limit > falls back to memory when redis throws
{"ts":"2026-02-18T05:33:59.533Z","level":"warn","message":"Redis rate limit fallback to memory","context":{"identifier":"redis-throws","error":"network"}}

 ✓ src/__tests__/lib/rate-limit.test.ts (6 tests) 803ms
     ✓ uses in-memory limiter when redis is not configured  559ms
 ✓ src/__tests__/lib/lead-notifier.test.ts (3 tests) 564ms
     ✓ no-ops when webhook is not configured  453ms
{"ts":"2026-02-18T05:33:59.704Z","level":"info","message":"Infrastructure lead captured","context":{"requestId":"b281d6ae-6e3d-4241-a3c7-2829f39db40c","organizationName":"Industrial Co","organizationType":"government_contractor","budgetRange":"60-120m-irr"}}
 ✓ src/__tests__/lib/site-config.test.ts (3 tests) 627ms
     ✓ uses NEXT_PUBLIC_SITE_URL when provided  513ms
 ✓ src/__tests__/lib/api-security.test.ts (5 tests) 34ms
stderr | src/__tests__/api/leads.integration.test.ts > lead API integration > ignores honeypot submissions without storing data
{"ts":"2026-02-18T05:33:59.795Z","level":"warn","message":"Honeypot trap triggered on lead endpoint","context":{"requestId":"52e4e3c0-ea61-4fe8-8f9b-abf38e343eeb","organizationName":"Industrial Co"}}

 ✓ src/__tests__/api/leads.integration.test.ts (3 tests) 864ms
     ✓ stores a valid lead request  766ms
 ✓ src/__tests__/api/ready.integration.test.ts (2 tests) 355ms
     ✓ returns 200 when database check succeeds  309ms
 ✓ src/__tests__/lib/env.test.ts (2 tests) 24ms
stderr | src/__tests__/api/messages.integration.test.ts > public messages route auth hardening > returns 500 when database read fails
{"ts":"2026-02-18T05:33:59.930Z","level":"error","message":"Error fetching messages","context":{"requestId":"0ef37618-d8d1-42f7-9498-1e6f1477d67c","error":"db"}}

 ✓ src/__tests__/lib/admin-auth.test.ts (3 tests) 420ms
     ✓ returns not_configured when no admin auth env exists  356ms
 ✓ src/__tests__/api/messages.integration.test.ts (5 tests) 669ms
     ✓ returns 503 when admin auth is not configured  543ms
 ✓ src/__tests__/api/admin-auth.integration.test.ts (6 tests) 895ms
     ✓ returns 503 when session auth is not configured  630ms
 ✓ src/__tests__/api/admin-routes.integration.test.ts (7 tests) 993ms
     ✓ returns 503 when admin auth is not configured  586ms
 ✓ src/__tests__/components/web-vitals.test.ts (3 tests) 5ms
 ✓ src/__tests__/lib/proxy-cache.test.ts (2 tests) 6ms
 ✓ src/__tests__/seo/sitemap.test.ts (1 test) 139ms
 ✓ src/__tests__/api/metrics.integration.test.ts (1 test) 173ms

 Test Files  20 passed (20)
      Tests  156 passed (156)
   Start at  05:33:55
   Duration  5.82s (transform 4.46s, setup 13.20s, import 5.01s, tests 6.85s, environment 26.04s)

