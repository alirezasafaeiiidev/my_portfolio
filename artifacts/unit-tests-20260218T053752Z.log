
> nextjs_tailwind_shadcn_ts@0.2.0 test /workspace/asdev-portfolio
> vitest run


 RUN  v4.0.18 /workspace/asdev-portfolio

 ✓ src/__tests__/seo/sitemap.test.ts (1 test) 301ms
 ✓ src/__tests__/lib/site-config.test.ts (3 tests) 467ms
     ✓ uses NEXT_PUBLIC_SITE_URL when provided  373ms
 ✓ src/__tests__/lib/persian-utils.test.ts (38 tests) 31ms
stderr | src/__tests__/lib/rate-limit.test.ts > rate-limit > falls back to memory when redis returns non-2xx
{"ts":"2026-02-18T05:38:40.404Z","level":"warn","message":"Redis rate limit request failed","context":{"status":500,"identifier":"redis-non-2xx"}}

stderr | src/__tests__/lib/rate-limit.test.ts > rate-limit > falls back to memory when redis throws
{"ts":"2026-02-18T05:38:40.474Z","level":"warn","message":"Redis rate limit fallback to memory","context":{"identifier":"redis-throws","error":"network"}}

 ✓ src/__tests__/lib/lead-notifier.test.ts (3 tests) 541ms
     ✓ no-ops when webhook is not configured  414ms
 ✓ src/__tests__/lib/logger.test.ts (2 tests) 140ms
 ✓ src/__tests__/lib/rate-limit.test.ts (6 tests) 921ms
     ✓ uses in-memory limiter when redis is not configured  658ms
 ✓ src/__tests__/lib/i18n-translations.test.ts (2 tests) 51ms
 ✓ src/__tests__/lib/security.test.ts (36 tests) 71ms
 ✓ src/__tests__/lib/admin-auth.test.ts (3 tests) 742ms
     ✓ returns not_configured when no admin auth env exists  634ms
 ✓ src/__tests__/api/metrics.integration.test.ts (1 test) 814ms
     ✓ returns prometheus text response  810ms
{"ts":"2026-02-18T05:38:40.948Z","level":"info","message":"Infrastructure lead captured","context":{"requestId":"675c4a02-62f1-42bb-ab3d-58ba8c80406e","organizationName":"Industrial Co","organizationType":"government_contractor","budgetRange":"60-120m-irr"}}
 ✓ src/__tests__/api/ready.integration.test.ts (2 tests) 914ms
     ✓ returns 200 when database check succeeds  824ms
 ✓ src/__tests__/lib/api-security.test.ts (5 tests) 19ms
stderr | src/__tests__/api/messages.integration.test.ts > public messages route auth hardening > returns 500 when database read fails
{"ts":"2026-02-18T05:38:41.011Z","level":"error","message":"Error fetching messages","context":{"requestId":"cb4c12be-3f6c-4031-861a-b7385bd71ee7","error":"db"}}

 ✓ src/__tests__/api/messages.integration.test.ts (5 tests) 892ms
     ✓ returns 503 when admin auth is not configured  763ms
stderr | src/__tests__/api/leads.integration.test.ts > lead API integration > ignores honeypot submissions without storing data
{"ts":"2026-02-18T05:38:41.029Z","level":"warn","message":"Honeypot trap triggered on lead endpoint","context":{"requestId":"1301e7fd-e9b6-41aa-9600-6583289809cb","organizationName":"Industrial Co"}}

 ✓ src/__tests__/api/leads.integration.test.ts (3 tests) 1001ms
     ✓ stores a valid lead request  883ms
 ✓ src/__tests__/api/admin-auth.integration.test.ts (6 tests) 961ms
     ✓ returns 503 when session auth is not configured  753ms
 ✓ src/__tests__/api/admin-routes.integration.test.ts (7 tests) 1108ms
     ✓ returns 503 when admin auth is not configured  764ms
 ✓ src/__tests__/lib/env.test.ts (2 tests) 8ms
 ✓ src/__tests__/lib/validators.test.ts (26 tests) 34ms
 ✓ src/__tests__/components/web-vitals.test.ts (3 tests) 6ms
 ✓ src/__tests__/lib/proxy-cache.test.ts (2 tests) 6ms

 Test Files  20 passed (20)
      Tests  156 passed (156)
   Start at  05:38:36
   Duration  6.33s (transform 5.67s, setup 14.96s, import 5.23s, tests 9.03s, environment 28.19s)

