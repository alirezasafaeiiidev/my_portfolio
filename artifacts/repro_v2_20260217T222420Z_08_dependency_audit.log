name=dependency_audit
command=pnpm audit --json
started_at=2026-02-17T22:27:36Z
{
  "actions": [
    {
      "action": "review",
      "module": "prismjs",
      "resolves": [
        {
          "id": 1105770,
          "path": ".>react-syntax-highlighter>refractor>prismjs",
          "dev": false,
          "optional": false,
          "bundled": false
        }
      ]
    },
    {
      "action": "review",
      "module": "tmp",
      "resolves": [
        {
          "id": 1109537,
          "path": ".>@lhci/cli>inquirer>external-editor>tmp",
          "dev": false,
          "optional": false,
          "bundled": false
        },
        {
          "id": 1109537,
          "path": ".>@lhci/cli>tmp",
          "dev": false,
          "optional": false,
          "bundled": false
        }
      ]
    },
    {
      "action": "review",
      "module": "ajv",
      "resolves": [
        {
          "id": 1113214,
          "path": ".>eslint>ajv",
          "dev": false,
          "optional": false,
          "bundled": false
        }
      ]
    }
  ],
  "advisories": {
    "1105770": {
      "findings": [
        {
          "version": "1.27.0",
          "paths": [
            ". > react-syntax-highlighter@15.6.6 > refractor@3.6.0 > prismjs@1.27.0"
          ]
        }
      ],
      "found_by": null,
      "deleted": null,
      "references": "- https://nvd.nist.gov/vuln/detail/CVE-2024-53382\n- https://gist.github.com/jackfromeast/aeb128e44f05f95828a1a824708df660\n- https://github.com/PrismJS/prism/blob/59e5a3471377057de1f401ba38337aca27b80e03/prism.js#L226-L259\n- https://github.com/PrismJS/prism/pull/3863\n- https://github.com/PrismJS/prism/commit/8e8b9352dac64457194dd9e51096b4772532e53d\n- https://github.com/advisories/GHSA-x7hr-w5r2-h6wg",
      "created": "2025-03-03T09:30:34.000Z",
      "id": 1105770,
      "npm_advisory_id": null,
      "overview": "Prism (aka PrismJS) through 1.29.0 allows DOM Clobbering (with resultant XSS for untrusted input that contains HTML but does not directly contain JavaScript), because document.currentScript lookup can be shadowed by attacker-injected HTML elements.",
      "reported_by": null,
      "title": "PrismJS DOM Clobbering vulnerability",
      "metadata": null,
      "cves": [
        "CVE-2024-53382"
      ],
      "access": "public",
      "severity": "moderate",
      "module_name": "prismjs",
      "vulnerable_versions": "<1.30.0",
      "github_advisory_id": "GHSA-x7hr-w5r2-h6wg",
      "recommendation": "Upgrade to version 1.30.0 or later",
      "patched_versions": ">=1.30.0",
      "updated": "2025-06-30T12:51:20.000Z",
      "cvss": {
        "score": 4.9,
        "vectorString": "CVSS:3.1/AV:N/AC:H/PR:L/UI:N/S:C/C:L/I:L/A:N"
      },
      "cwe": [
        "CWE-79",
        "CWE-94"
      ],
      "url": "https://github.com/advisories/GHSA-x7hr-w5r2-h6wg"
    },
    "1109537": {
      "findings": [
        {
          "version": "0.0.33",
          "paths": [
            ". > @lhci/cli@0.15.1 > inquirer@6.5.2 > external-editor@3.1.0 > tmp@0.0.33"
          ]
        },
        {
          "version": "0.1.0",
          "paths": [
            ". > @lhci/cli@0.15.1 > tmp@0.1.0"
          ]
        }
      ],
      "found_by": null,
      "deleted": null,
      "references": "- https://github.com/raszi/node-tmp/security/advisories/GHSA-52f5-9888-hmc6\n- https://github.com/raszi/node-tmp/commit/188b25e529496e37adaf1a1d9dccb40019a08b1b\n- https://nvd.nist.gov/vuln/detail/CVE-2025-54798\n- https://github.com/raszi/node-tmp/issues/207\n- https://lists.debian.org/debian-lts-announce/2025/08/msg00007.html\n- https://github.com/advisories/GHSA-52f5-9888-hmc6",
      "created": "2025-08-06T17:06:04.000Z",
      "id": 1109537,
      "npm_advisory_id": null,
      "overview": "### Summary\n\n`tmp@0.2.3` is vulnerable to an Arbitrary temporary file / directory write via symbolic link `dir` parameter.\n\n\n### Details\n\nAccording to the documentation there are some conditions that must be held:\n\n```\n// https://github.com/raszi/node-tmp/blob/v0.2.3/README.md?plain=1#L41-L50\n\nOther breaking changes, i.e.\n\n- template must be relative to tmpdir\n- name must be relative to tmpdir\n- dir option must be relative to tmpdir //<-- this assumption can be bypassed using symlinks\n\nare still in place.\n\nIn order to override the system's tmpdir, you will have to use the newly\nintroduced tmpdir option.\n\n\n// https://github.com/raszi/node-tmp/blob/v0.2.3/README.md?plain=1#L375\n* `dir`: the optional temporary directory that must be relative to the system's default temporary directory.\n     absolute paths are fine as long as they point to a location under the system's default temporary directory.\n     Any directories along the so specified path must exist, otherwise a ENOENT error will be thrown upon access, \n     as tmp will not check the availability of the path, nor will it establish the requested path for you.\n```\n\nRelated issue: https://github.com/raszi/node-tmp/issues/207.\n\n\nThe issue occurs because `_resolvePath` does not properly handle symbolic link when resolving paths:\n```js\n// https://github.com/raszi/node-tmp/blob/v0.2.3/lib/tmp.js#L573-L579\nfunction _resolvePath(name, tmpDir) {\n  if (name.startsWith(tmpDir)) {\n    return path.resolve(name);\n  } else {\n    return path.resolve(path.join(tmpDir, name));\n  }\n}\n```\n\nIf the `dir` parameter points to a symlink that resolves to a folder outside the `tmpDir`, it's possible to bypass the `_assertIsRelative` check used in `_assertAndSanitizeOptions`:\n```js\n// https://github.com/raszi/node-tmp/blob/v0.2.3/lib/tmp.js#L590-L609\nfunction _assertIsRelative(name, option, tmpDir) {\n  if (option === 'name') {\n    // assert that name is not absolute and does not contain a path\n    if (path.isAbsolute(name))\n      throw new Error(`${option} option must not contain an absolute path, found \"${name}\".`);\n    // must not fail on valid .<name> or ..<name> or similar such constructs\n    let basename = path.basename(name);\n    if (basename === '..' || basename === '.' || basename !== name)\n      throw new Error(`${option} option must not contain a path, found \"${name}\".`);\n  }\n  else { // if (option === 'dir' || option === 'template') {\n    // assert that dir or template are relative to tmpDir\n    if (path.isAbsolute(name) && !name.startsWith(tmpDir)) {\n      throw new Error(`${option} option must be relative to \"${tmpDir}\", found \"${name}\".`);\n    }\n    let resolvedPath = _resolvePath(name, tmpDir); //<--- \n    if (!resolvedPath.startsWith(tmpDir))\n      throw new Error(`${option} option must be relative to \"${tmpDir}\", found \"${resolvedPath}\".`);\n  }\n}\n```\n\n\n### PoC\n\nThe following PoC demonstrates how writing a tmp file on a folder outside the `tmpDir` is possible.\nTested on a Linux machine.\n\n- Setup: create a symbolic link inside the `tmpDir` that points to a directory outside of it\n```bash\nmkdir $HOME/mydir1\n\nln -s $HOME/mydir1 ${TMPDIR:-/tmp}/evil-dir\n```\n\n- check the folder is empty:\n```bash\nls -lha $HOME/mydir1 | grep \"tmp-\"\n```\n\n- run the poc\n```bash\nnode main.js\nFile:  /tmp/evil-dir/tmp-26821-Vw87SLRaBIlf\ntest 1: ENOENT: no such file or directory, open '/tmp/mydir1/tmp-[random-id]'\ntest 2: dir option must be relative to \"/tmp\", found \"/foo\".\ntest 3: dir option must be relative to \"/tmp\", found \"/home/user/mydir1\".\n```\n\n- the temporary file is created under `$HOME/mydir1` (outside the `tmpDir`):\n```bash\nls -lha $HOME/mydir1 | grep \"tmp-\"\n-rw------- 1 user user    0 Apr  X XX:XX tmp-[random-id]\n```\n\n\n- `main.js`\n```js\n// npm i tmp@0.2.3\n\nconst tmp = require('tmp');\n\nconst tmpobj = tmp.fileSync({ 'dir': 'evil-dir'});\nconsole.log('File: ', tmpobj.name);\n\ntry {\n    tmp.fileSync({ 'dir': 'mydir1'});\n} catch (err) {\n    console.log('test 1:', err.message)\n}\n\ntry {\n    tmp.fileSync({ 'dir': '/foo'});\n} catch (err) {\n    console.log('test 2:', err.message)\n}\n\ntry {\n    const fs = require('node:fs');\n    const resolved = fs.realpathSync('/tmp/evil-dir');\n    tmp.fileSync({ 'dir': resolved});\n} catch (err) {\n    console.log('test 3:', err.message)\n}\n```\n\n\nA Potential fix could be to call `fs.realpathSync` (or similar) that resolves also symbolic links.\n```js\nfunction _resolvePath(name, tmpDir) {\n  let resolvedPath;\n  if (name.startsWith(tmpDir)) {\n    resolvedPath = path.resolve(name);\n  } else {\n    resolvedPath = path.resolve(path.join(tmpDir, name));\n  }\n  return fs.realpathSync(resolvedPath);\n}\n```\n\n\n### Impact\n\nArbitrary temporary file / directory write via symlink",
      "reported_by": null,
      "title": "tmp allows arbitrary temporary file / directory write via symbolic link `dir` parameter",
      "metadata": null,
      "cves": [
        "CVE-2025-54798"
      ],
      "access": "public",
      "severity": "low",
      "module_name": "tmp",
      "vulnerable_versions": "<=0.2.3",
      "github_advisory_id": "GHSA-52f5-9888-hmc6",
      "recommendation": "Upgrade to version 0.2.4 or later",
      "patched_versions": ">=0.2.4",
      "updated": "2025-11-03T21:34:21.000Z",
      "cvss": {
        "score": 2.5,
        "vectorString": "CVSS:3.1/AV:L/AC:H/PR:L/UI:N/S:U/C:N/I:L/A:N"
      },
      "cwe": [
        "CWE-59"
      ],
      "url": "https://github.com/advisories/GHSA-52f5-9888-hmc6"
    },
    "1113214": {
      "findings": [
        {
          "version": "6.12.6",
          "paths": [
            ". > eslint@9.39.2 > @eslint/eslintrc@3.3.3 > ajv@6.12.6",
            ". > eslint@9.39.2 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > eslint@9.39.2 > @eslint/eslintrc@3.3.3 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > eslint@9.39.2 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > eslint-import-resolver-typescript@3.10.1 > eslint@9.39.2 > @eslint/eslintrc@3.3.3 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > eslint-import-resolver-typescript@3.10.1 > eslint@9.39.2 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > eslint-import-resolver-typescript@3.10.1 > eslint-plugin-import@2.32.0 > eslint@9.39.2 > @eslint/eslintrc@3.3.3 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > eslint-import-resolver-typescript@3.10.1 > eslint-plugin-import@2.32.0 > eslint@9.39.2 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > eslint-import-resolver-typescript@3.10.1 > eslint-plugin-import@2.32.0 > eslint-module-utils@2.12.1 > @typescript-eslint/parser@8.55.0 > eslint@9.39.2 > @eslint/eslintrc@3.3.3 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > eslint-import-resolver-typescript@3.10.1 > eslint-plugin-import@2.32.0 > eslint-module-utils@2.12.1 > @typescript-eslint/parser@8.55.0 > eslint@9.39.2 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > eslint-import-resolver-typescript@3.10.1 > eslint-plugin-import@2.32.0 > eslint-module-utils@2.12.1 > eslint@9.39.2 > @eslint/eslintrc@3.3.3 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > eslint-import-resolver-typescript@3.10.1 > eslint-plugin-import@2.32.0 > eslint-module-utils@2.12.1 > eslint@9.39.2 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > eslint-import-resolver-typescript@3.10.1 > eslint-plugin-import@2.32.0 > @typescript-eslint/parser@8.55.0 > eslint@9.39.2 > @eslint/eslintrc@3.3.3 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > eslint-import-resolver-typescript@3.10.1 > eslint-plugin-import@2.32.0 > @typescript-eslint/parser@8.55.0 > eslint@9.39.2 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > eslint-plugin-import@2.32.0 > eslint@9.39.2 > @eslint/eslintrc@3.3.3 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > eslint-plugin-import@2.32.0 > eslint@9.39.2 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > eslint-plugin-import@2.32.0 > eslint-module-utils@2.12.1 > @typescript-eslint/parser@8.55.0 > eslint@9.39.2 > @eslint/eslintrc@3.3.3 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > eslint-plugin-import@2.32.0 > eslint-module-utils@2.12.1 > @typescript-eslint/parser@8.55.0 > eslint@9.39.2 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > eslint-plugin-import@2.32.0 > eslint-module-utils@2.12.1 > eslint@9.39.2 > @eslint/eslintrc@3.3.3 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > eslint-plugin-import@2.32.0 > eslint-module-utils@2.12.1 > eslint@9.39.2 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > eslint-plugin-import@2.32.0 > @typescript-eslint/parser@8.55.0 > eslint@9.39.2 > @eslint/eslintrc@3.3.3 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > eslint-plugin-import@2.32.0 > @typescript-eslint/parser@8.55.0 > eslint@9.39.2 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > eslint-plugin-jsx-a11y@6.10.2 > eslint@9.39.2 > @eslint/eslintrc@3.3.3 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > eslint-plugin-jsx-a11y@6.10.2 > eslint@9.39.2 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > eslint-plugin-react@7.37.5 > eslint@9.39.2 > @eslint/eslintrc@3.3.3 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > eslint-plugin-react@7.37.5 > eslint@9.39.2 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > eslint-plugin-react-hooks@7.0.1 > eslint@9.39.2 > @eslint/eslintrc@3.3.3 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > eslint-plugin-react-hooks@7.0.1 > eslint@9.39.2 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > typescript-eslint@8.55.0 > @typescript-eslint/eslint-plugin@8.55.0 > @typescript-eslint/parser@8.55.0 > eslint@9.39.2 > @eslint/eslintrc@3.3.3 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > typescript-eslint@8.55.0 > @typescript-eslint/eslint-plugin@8.55.0 > @typescript-eslint/parser@8.55.0 > eslint@9.39.2 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > typescript-eslint@8.55.0 > @typescript-eslint/eslint-plugin@8.55.0 > @typescript-eslint/type-utils@8.55.0 > @typescript-eslint/utils@8.55.0 > eslint@9.39.2 > @eslint/eslintrc@3.3.3 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > typescript-eslint@8.55.0 > @typescript-eslint/eslint-plugin@8.55.0 > @typescript-eslint/type-utils@8.55.0 > @typescript-eslint/utils@8.55.0 > eslint@9.39.2 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > typescript-eslint@8.55.0 > @typescript-eslint/eslint-plugin@8.55.0 > @typescript-eslint/type-utils@8.55.0 > eslint@9.39.2 > @eslint/eslintrc@3.3.3 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > typescript-eslint@8.55.0 > @typescript-eslint/eslint-plugin@8.55.0 > @typescript-eslint/type-utils@8.55.0 > eslint@9.39.2 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > typescript-eslint@8.55.0 > @typescript-eslint/eslint-plugin@8.55.0 > @typescript-eslint/utils@8.55.0 > eslint@9.39.2 > @eslint/eslintrc@3.3.3 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > typescript-eslint@8.55.0 > @typescript-eslint/eslint-plugin@8.55.0 > @typescript-eslint/utils@8.55.0 > eslint@9.39.2 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > typescript-eslint@8.55.0 > @typescript-eslint/eslint-plugin@8.55.0 > eslint@9.39.2 > @eslint/eslintrc@3.3.3 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > typescript-eslint@8.55.0 > @typescript-eslint/eslint-plugin@8.55.0 > eslint@9.39.2 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > typescript-eslint@8.55.0 > @typescript-eslint/parser@8.55.0 > eslint@9.39.2 > @eslint/eslintrc@3.3.3 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > typescript-eslint@8.55.0 > @typescript-eslint/parser@8.55.0 > eslint@9.39.2 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > typescript-eslint@8.55.0 > @typescript-eslint/utils@8.55.0 > eslint@9.39.2 > @eslint/eslintrc@3.3.3 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > typescript-eslint@8.55.0 > @typescript-eslint/utils@8.55.0 > eslint@9.39.2 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > typescript-eslint@8.55.0 > eslint@9.39.2 > @eslint/eslintrc@3.3.3 > ajv@6.12.6",
            ". > eslint-config-next@16.1.6 > typescript-eslint@8.55.0 > eslint@9.39.2 > ajv@6.12.6",
            ". > ajv@6.12.6"
          ]
        }
      ],
      "found_by": null,
      "deleted": null,
      "references": "- https://nvd.nist.gov/vuln/detail/CVE-2025-69873\n- https://github.com/EthanKim88/ethan-cve-disclosures/blob/main/CVE-2025-69873-ajv-ReDoS.md\n- https://github.com/ajv-validator/ajv/pull/2586\n- https://github.com/ajv-validator/ajv/commit/720a23fa453ffae8340e92c9b0fe886c54cfe0d5\n- https://github.com/ajv-validator/ajv/releases/tag/v8.18.0\n- https://github.com/advisories/GHSA-2g4f-4pwh-qvx6",
      "created": "2026-02-11T21:30:39.000Z",
      "id": 1113214,
      "npm_advisory_id": null,
      "overview": "ajv (Another JSON Schema Validator) through version 8.17.1 is vulnerable to Regular Expression Denial of Service (ReDoS) when the `$data` option is enabled. The pattern keyword accepts runtime data via JSON Pointer syntax (`$data` reference), which is passed directly to the JavaScript `RegExp()` constructor without validation. An attacker can inject a malicious regex pattern (e.g., `\\\"^(a|a)*$\\\"`) combined with crafted input to cause catastrophic backtracking. A 31-character payload causes approximately 44 seconds of CPU blocking, with each additional character doubling execution time. This enables complete denial of service with a single HTTP request against any API using ajv with `$data`: true for dynamic schema validation.",
      "reported_by": null,
      "title": "ajv has ReDoS when using `$data` option",
      "metadata": null,
      "cves": [
        "CVE-2025-69873"
      ],
      "access": "public",
      "severity": "moderate",
      "module_name": "ajv",
      "vulnerable_versions": "<8.18.0",
      "github_advisory_id": "GHSA-2g4f-4pwh-qvx6",
      "recommendation": "Upgrade to version 8.18.0 or later",
      "patched_versions": ">=8.18.0",
      "updated": "2026-02-17T18:13:07.000Z",
      "cvss": {
        "score": 0,
        "vectorString": null
      },
      "cwe": [
        "CWE-400"
      ],
      "url": "https://github.com/advisories/GHSA-2g4f-4pwh-qvx6"
    }
  },
  "muted": [],
  "metadata": {
    "vulnerabilities": {
      "info": 0,
      "low": 2,
      "moderate": 2,
      "high": 0,
      "critical": 0
    },
    "dependencies": 1325,
    "devDependencies": 0,
    "optionalDependencies": 0,
    "totalDependencies": 1325
  }
}
exit_code=1
finished_at=2026-02-17T22:27:40Z
