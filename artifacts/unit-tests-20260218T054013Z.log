
> nextjs_tailwind_shadcn_ts@0.2.0 test /workspace/asdev-portfolio
> vitest run


 RUN  v4.0.18 /workspace/asdev-portfolio

 ✓ src/__tests__/lib/logger.test.ts (2 tests) 48ms
 ✓ src/__tests__/api/metrics.integration.test.ts (1 test) 436ms
     ✓ returns prometheus text response  431ms
 ✓ src/__tests__/lib/site-config.test.ts (3 tests) 556ms
     ✓ uses NEXT_PUBLIC_SITE_URL when provided  480ms
 ✓ src/__tests__/lib/i18n-translations.test.ts (2 tests) 28ms
 ✓ src/__tests__/lib/security.test.ts (36 tests) 41ms
 ✓ src/__tests__/lib/lead-notifier.test.ts (3 tests) 564ms
     ✓ no-ops when webhook is not configured  491ms
stderr | src/__tests__/lib/rate-limit.test.ts > rate-limit > falls back to memory when redis returns non-2xx
{"ts":"2026-02-18T05:40:54.989Z","level":"warn","message":"Redis rate limit request failed","context":{"status":500,"identifier":"redis-non-2xx"}}

stderr | src/__tests__/lib/rate-limit.test.ts > rate-limit > falls back to memory when redis throws
{"ts":"2026-02-18T05:40:55.021Z","level":"warn","message":"Redis rate limit fallback to memory","context":{"identifier":"redis-throws","error":"network"}}

 ✓ src/__tests__/seo/sitemap.test.ts (1 test) 378ms
     ✓ contains only indexable URLs and no hash fragments  374ms
 ✓ src/__tests__/lib/rate-limit.test.ts (6 tests) 717ms
     ✓ uses in-memory limiter when redis is not configured  497ms
 ✓ src/__tests__/lib/admin-auth.test.ts (3 tests) 576ms
     ✓ returns not_configured when no admin auth env exists  447ms
stderr | src/__tests__/api/messages.integration.test.ts > public messages route auth hardening > returns 500 when database read fails
{"ts":"2026-02-18T05:40:55.283Z","level":"error","message":"Error fetching messages","context":{"requestId":"be01dc90-a77c-42d2-8d68-0c7a64a6b4c4","error":"db"}}

 ✓ src/__tests__/api/messages.integration.test.ts (5 tests) 916ms
     ✓ returns 503 when admin auth is not configured  783ms
 ✓ src/__tests__/api/ready.integration.test.ts (2 tests) 616ms
     ✓ returns 200 when database check succeeds  551ms
 ✓ src/__tests__/lib/validators.test.ts (26 tests) 39ms
{"ts":"2026-02-18T05:40:55.350Z","level":"info","message":"Infrastructure lead captured","context":{"requestId":"91810be9-2a83-4b64-b363-a532d37241e4","organizationName":"Industrial Co","organizationType":"government_contractor","budgetRange":"60-120m-irr"}}
 ✓ src/__tests__/api/admin-auth.integration.test.ts (6 tests) 1054ms
     ✓ returns 503 when session auth is not configured  561ms
     ✓ returns session status for bearer token auth  308ms
 ✓ src/__tests__/lib/persian-utils.test.ts (38 tests) 52ms
stderr | src/__tests__/api/leads.integration.test.ts > lead API integration > ignores honeypot submissions without storing data
{"ts":"2026-02-18T05:40:55.486Z","level":"warn","message":"Honeypot trap triggered on lead endpoint","context":{"requestId":"521daacb-30b9-4764-a6ee-d07c849bf17e","organizationName":"Industrial Co"}}

 ✓ src/__tests__/api/leads.integration.test.ts (3 tests) 1128ms
     ✓ stores a valid lead request  1029ms
 ✓ src/__tests__/api/admin-routes.integration.test.ts (7 tests) 1019ms
     ✓ returns 503 when admin auth is not configured  668ms
 ✓ src/__tests__/lib/api-security.test.ts (5 tests) 11ms
 ✓ src/__tests__/lib/env.test.ts (2 tests) 11ms
 ✓ src/__tests__/components/web-vitals.test.ts (3 tests) 10ms
 ✓ src/__tests__/lib/proxy-cache.test.ts (2 tests) 6ms

 Test Files  20 passed (20)
      Tests  156 passed (156)
   Start at  05:40:50
   Duration  6.43s (transform 4.39s, setup 14.50s, import 4.17s, tests 8.21s, environment 29.78s)

